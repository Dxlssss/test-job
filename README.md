Написан ansible playbook, который:
1)
- содержит удаленный сервер(который необходимо указать)
- выполняет задачи под root
- present (проверяет есть или нет зависимость)
2)
выполняет такие задачи как:
- Устанавливает необходимые пакеты для Docker
- добавляет gpg, для доверия пакетам докера
- Добавляет стабильную версию докер репо на удаленный серв
- Устанавливает докер
- Устанавливает докер компос на удаленный серв с правами рута, и выдает права 755
- Перекидывает yml файл докер-компоса на удаленный серв
- копирует шаблон nginx.conf.j2 на удаленный серв и рестартуер nginx( restart nginx.conf.
- Запускает докер компос
- При необходимости перезапускает nginx( вызван notify, что бы в случае чего выполнить handlers - которые перезапускают nginx)
